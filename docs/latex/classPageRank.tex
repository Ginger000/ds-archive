\hypertarget{classPageRank}{}\doxysection{Page\+Rank Class Reference}
\label{classPageRank}\index{PageRank@{PageRank}}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
double \mbox{\hyperlink{classPageRank_ab3dad94300779afb557d12fc20a06790}{get\+Rank}} (std\+::string link)
\item 
\mbox{\Hypertarget{classPageRank_aa9437f5944906532bdbabf93d3c76a71}\label{classPageRank_aa9437f5944906532bdbabf93d3c76a71}} 
{\bfseries Page\+Rank} (\mbox{\hyperlink{classGraph}{Graph}} \&g)
\item 
\mbox{\hyperlink{classPageRank_aad98b4d4ad96cdbdf8b2c441ed088f6d}{Page\+Rank}} (\mbox{\hyperlink{classGraph}{Graph}} \&g, double alpha, double tol)
\item 
\mbox{\Hypertarget{classPageRank_a1fc2facc71af8ce830908d3364eab627}\label{classPageRank_a1fc2facc71af8ce830908d3364eab627}} 
std\+::pair$<$ int, double $>$ {\bfseries precision} ()
\item 
\mbox{\Hypertarget{classPageRank_a725ad3459a7dba3729c6190548cefba1}\label{classPageRank_a725ad3459a7dba3729c6190548cefba1}} 
double {\bfseries operator\mbox{[}$\,$\mbox{]}} (std\+::string link)
\item 
std\+::unordered\+\_\+map$<$ std\+::string, double $>$ \mbox{\hyperlink{classPageRank_afd8a561dd75ff2b882fd05668a43e535}{get\+All\+Rank}} ()
\item 
void \mbox{\hyperlink{classPageRank_a53f6475f0e0aa127a5ebdbe1ebdd5f1d}{save\+Rank\+To\+File}} (std\+::string output, int end\+Iteration\+Idx)
\item 
void \mbox{\hyperlink{classPageRank_a0da9fcf460cccc1908b113cdef94722f}{print\+Ranks}} (int end\+Iteration\+Idx)
\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classPageRank_a5ffcde308a49d552ef4bf8d69bc5999f}{construct\+Dual\+Graph}} ()
\item 
void \mbox{\hyperlink{classPageRank_a7597b793053818ef03443fa42381aab3}{calculate\+Rank}} (double alpha, double tol)
\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classPageRank_a4d1acf9c17526e627940e163dcace171}\label{classPageRank_a4d1acf9c17526e627940e163dcace171}} 
\mbox{\hyperlink{classGraph}{Graph}} \& {\bfseries graph}
\item 
\mbox{\Hypertarget{classPageRank_ab409a6e7cc42a874c866e02749eb51f2}\label{classPageRank_ab409a6e7cc42a874c866e02749eb51f2}} 
size\+\_\+t {\bfseries iterations}
\item 
\mbox{\Hypertarget{classPageRank_a2cb75c4e57ebb5087ea97c558c25eab1}\label{classPageRank_a2cb75c4e57ebb5087ea97c558c25eab1}} 
double {\bfseries error}
\item 
\mbox{\Hypertarget{classPageRank_a3a45433f2c400a733600185e4d1a71ed}\label{classPageRank_a3a45433f2c400a733600185e4d1a71ed}} 
std\+::unordered\+\_\+map$<$ std\+::string, std\+::pair$<$ int, std\+::vector$<$ std\+::string $>$ $>$ $>$ {\bfseries dual\+Wiki\+Graph}
\item 
\mbox{\Hypertarget{classPageRank_a5d2ccc370b1a52eb53b46092fb65db55}\label{classPageRank_a5d2ccc370b1a52eb53b46092fb65db55}} 
std\+::unordered\+\_\+map$<$ std\+::string, double $>$ {\bfseries page\+Rank}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 9 of file Page\+Rank.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classPageRank_aad98b4d4ad96cdbdf8b2c441ed088f6d}\label{classPageRank_aad98b4d4ad96cdbdf8b2c441ed088f6d}} 
\index{PageRank@{PageRank}!PageRank@{PageRank}}
\index{PageRank@{PageRank}!PageRank@{PageRank}}
\doxysubsubsection{\texorpdfstring{PageRank()}{PageRank()}}
{\footnotesize\ttfamily Page\+Rank\+::\+Page\+Rank (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classGraph}{Graph}} \&}]{g,  }\item[{double}]{alpha,  }\item[{double}]{tol }\end{DoxyParamCaption})}

Customized constructor of \mbox{\hyperlink{classPageRank}{Page\+Rank}}


\begin{DoxyParams}{Parameters}
{\em g} & the base graph \\
\hline
{\em alpha} & the dumping factor, representing the possibility for a user to keep browsing or open a new page \\
\hline
{\em tol} & the tolerence for convergence \\
\hline
\end{DoxyParams}


Definition at line 39 of file Page\+Rank.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{39                                                      : graph(g) \{}
\DoxyCodeLine{40   \mbox{\hyperlink{classPageRank_a5ffcde308a49d552ef4bf8d69bc5999f}{constructDualGraph}}();}
\DoxyCodeLine{41   \mbox{\hyperlink{classPageRank_a7597b793053818ef03443fa42381aab3}{calculateRank}}(alpha, tol);}
\DoxyCodeLine{42 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classPageRank_a7597b793053818ef03443fa42381aab3}\label{classPageRank_a7597b793053818ef03443fa42381aab3}} 
\index{PageRank@{PageRank}!calculateRank@{calculateRank}}
\index{calculateRank@{calculateRank}!PageRank@{PageRank}}
\doxysubsubsection{\texorpdfstring{calculateRank()}{calculateRank()}}
{\footnotesize\ttfamily void Page\+Rank\+::calculate\+Rank (\begin{DoxyParamCaption}\item[{double}]{alpha,  }\item[{double}]{tol }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Calculates pagerank of all pages. Page Rank is proportional to the posibility of a user browsing the wikipage via links in the page that stays at a particular webpage. Iteratively, each page \char`\"{}votes\char`\"{} its rank to the pages that it has links pointing to, with a correction mimicing random browsing.


\begin{DoxyParams}{Parameters}
{\em alpha} & The dumping factor, representing the possibility for a user to keep browsing or open a new page \\
\hline
{\em tol} & Tolerance for convergence. \\
\hline
\end{DoxyParams}


Definition at line 70 of file Page\+Rank.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{70                                                      \{}
\DoxyCodeLine{71   std::cout << \textcolor{stringliteral}{"{}Start calculating Page Rank of the graph of size : "{}} << graph.\mbox{\hyperlink{classGraph_a7d016a176241e35cfe0d15d3d9f05eae}{size}}() << std::endl;}
\DoxyCodeLine{72   std::cout << \textcolor{stringliteral}{"{}This may takes up to 1 minutes."{}} << std::endl;}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   \textcolor{keyword}{auto} vertices = graph.\mbox{\hyperlink{classGraph_a62dc15aaab3d1a5e4268f6218d1cbbad}{getVertices}}();}
\DoxyCodeLine{75 }
\DoxyCodeLine{76   pageRank.reserve(graph.\mbox{\hyperlink{classGraph_a7d016a176241e35cfe0d15d3d9f05eae}{size}}());}
\DoxyCodeLine{77 }
\DoxyCodeLine{78   \textcolor{comment}{// initalize the page rank, with all values = 1;}}
\DoxyCodeLine{79   \textcolor{keyword}{auto} buffer = pageRank;}
\DoxyCodeLine{80   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&vertex : vertices) \{}
\DoxyCodeLine{81     pageRank[vertex] = 1;}
\DoxyCodeLine{82     buffer[vertex] = 0;}
\DoxyCodeLine{83   \}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85   \textcolor{keywordtype}{double} differences = 1;}
\DoxyCodeLine{86   \textcolor{keywordtype}{int} counter = 0;}
\DoxyCodeLine{87   \textcolor{keywordtype}{double} totalCountOfVertices = (double) graph.\mbox{\hyperlink{classGraph_a7d016a176241e35cfe0d15d3d9f05eae}{size}}();}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 }
\DoxyCodeLine{90   \textcolor{comment}{// find all wiki page that has no links pointing outwards;}}
\DoxyCodeLine{91   std::unordered\_set<std::string> leaves;}
\DoxyCodeLine{92   leaves.reserve(graph.\mbox{\hyperlink{classGraph_a7d016a176241e35cfe0d15d3d9f05eae}{size}}());}
\DoxyCodeLine{93   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&vertex: vertices) \{}
\DoxyCodeLine{94     \textcolor{keywordflow}{if} (graph.\mbox{\hyperlink{classGraph_a737d9371632e267eb80948786e360183}{getDegree}}(vertex) == 0) \{}
\DoxyCodeLine{95       leaves.emplace(vertex);}
\DoxyCodeLine{96     \}}
\DoxyCodeLine{97   \}}
\DoxyCodeLine{98 }
\DoxyCodeLine{99   \textcolor{comment}{// std::ofstream f;}}
\DoxyCodeLine{100   \textcolor{comment}{// f.open("{}testPageRank.txt"{});}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102   \textcolor{comment}{// page rank is calcualted iteratively, with each iteration representing the "{}voting"{} of possibilities of one page through its link pointing to others.}}
\DoxyCodeLine{103   \textcolor{comment}{// If a page has 3 links, it will contribute to the page rank of its children by dividing its rank into 3 even parts and adding them to the ranks of their children in the next iteration}}
\DoxyCodeLine{104   \textcolor{keywordflow}{while} (differences > tol \&\& counter < Max\_Iteration) \{}
\DoxyCodeLine{105 }
\DoxyCodeLine{106     differences = 0;}
\DoxyCodeLine{107     \textcolor{comment}{// the main "{}voting"{} procedure}}
\DoxyCodeLine{108     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&vertex : vertices) \{}
\DoxyCodeLine{109       buffer[vertex] = 0;}
\DoxyCodeLine{110       \textcolor{comment}{//f<<"{}Vertex :"{}<<vertex<<"{} has "{}<<dualWikiGraph[vertex].first<<"{} many parents"{}<<std::endl;}}
\DoxyCodeLine{111       \textcolor{keyword}{auto} parents = dualWikiGraph[vertex].second;}
\DoxyCodeLine{112       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&parent : parents) \{}
\DoxyCodeLine{113         \textcolor{keywordtype}{double} factor = graph.\mbox{\hyperlink{classGraph_a737d9371632e267eb80948786e360183}{getDegree}}(parent);}
\DoxyCodeLine{114         \textcolor{comment}{//f<<"{} "{}<<"{}It's parent : "{}<<parent<<"{} has "{}<<factor<<"{} many children."{}<<std::endl;}}
\DoxyCodeLine{115         buffer[vertex] += alpha * pageRank[parent] / factor;}
\DoxyCodeLine{116       \}}
\DoxyCodeLine{117     \}}
\DoxyCodeLine{118 }
\DoxyCodeLine{119     \textcolor{comment}{// corrections made to let leaf nodes spit out its rank, otherwise all non-\/leave pages will have rank 0}}
\DoxyCodeLine{120     \textcolor{keywordtype}{double} correction = 0;}
\DoxyCodeLine{121     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&leaf : leaves) \{}
\DoxyCodeLine{122       correction += pageRank[leaf] / totalCountOfVertices;}
\DoxyCodeLine{123     \}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125     \textcolor{comment}{// corrections made to let the algorithms converge, with damping factor alpha.}}
\DoxyCodeLine{126     \textcolor{keywordtype}{double} sum = 0;}
\DoxyCodeLine{127     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&vertex :vertices) \{}
\DoxyCodeLine{128       sum += pageRank[vertex] / totalCountOfVertices;}
\DoxyCodeLine{129     \}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131     \textcolor{comment}{// find the differences between two iterations for tolerence test}}
\DoxyCodeLine{132     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&vertex : vertices) \{}
\DoxyCodeLine{133       buffer[vertex] = buffer[vertex] + alpha * correction + (1 -\/ alpha) * sum;}
\DoxyCodeLine{134       differences = std::max(differences, std::abs(pageRank[vertex] -\/ buffer[vertex]));}
\DoxyCodeLine{135     \}}
\DoxyCodeLine{136 }
\DoxyCodeLine{137     pageRank = buffer;}
\DoxyCodeLine{138     ++counter;}
\DoxyCodeLine{139     std::cout << \textcolor{stringliteral}{"{}Current iteration : "{}} << counter << \textcolor{stringliteral}{"{} with error :"{}} << differences << std::endl;}
\DoxyCodeLine{140 }
\DoxyCodeLine{141     \textcolor{comment}{// f<<"{}Iterator : "{}<<counter<<"{}, correction : "{}<<correction<<"{}, sum : "{}<<sum<<std::endl;}}
\DoxyCodeLine{142     \textcolor{comment}{// for(auto\& vertex : vertices)\{}}
\DoxyCodeLine{143     \textcolor{comment}{//     f<<vertex<<"{} has rank : "{}<<pageRank[vertex]<<std::endl;}}
\DoxyCodeLine{144     \textcolor{comment}{// \}}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146   \}}
\DoxyCodeLine{147 }
\DoxyCodeLine{148   \textcolor{comment}{//close();}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150   \textcolor{comment}{//convergency parameter}}
\DoxyCodeLine{151   iterations = counter;}
\DoxyCodeLine{152   error = differences;}
\DoxyCodeLine{153 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classPageRank_a5ffcde308a49d552ef4bf8d69bc5999f}\label{classPageRank_a5ffcde308a49d552ef4bf8d69bc5999f}} 
\index{PageRank@{PageRank}!constructDualGraph@{constructDualGraph}}
\index{constructDualGraph@{constructDualGraph}!PageRank@{PageRank}}
\doxysubsubsection{\texorpdfstring{constructDualGraph()}{constructDualGraph()}}
{\footnotesize\ttfamily void Page\+Rank\+::construct\+Dual\+Graph (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Created a new graph, based on the original one, with all arrows reversed. 

Definition at line 47 of file Page\+Rank.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{47                                   \{}
\DoxyCodeLine{48   std::unordered\_set<std::string> vertices = graph.\mbox{\hyperlink{classGraph_a62dc15aaab3d1a5e4268f6218d1cbbad}{getVertices}}();}
\DoxyCodeLine{49   dualWikiGraph.reserve(graph.\mbox{\hyperlink{classGraph_a7d016a176241e35cfe0d15d3d9f05eae}{size}}());}
\DoxyCodeLine{50   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} source : vertices) \{}
\DoxyCodeLine{51     \textcolor{keyword}{auto} edges = graph.\mbox{\hyperlink{classGraph_ac8507d9150c2eca50728a892150f1717}{getChildren}}(source);}
\DoxyCodeLine{52     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&target : edges) \{}
\DoxyCodeLine{53       dualWikiGraph[target].second.push\_back(source);}
\DoxyCodeLine{54     \}}
\DoxyCodeLine{55   \}}
\DoxyCodeLine{56   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&target : vertices) \{}
\DoxyCodeLine{57     std::pair<int, std::vector<std::string>> \&children = dualWikiGraph[target];}
\DoxyCodeLine{58     children.first = children.second.size();}
\DoxyCodeLine{59   \}}
\DoxyCodeLine{60 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classPageRank_afd8a561dd75ff2b882fd05668a43e535}\label{classPageRank_afd8a561dd75ff2b882fd05668a43e535}} 
\index{PageRank@{PageRank}!getAllRank@{getAllRank}}
\index{getAllRank@{getAllRank}!PageRank@{PageRank}}
\doxysubsubsection{\texorpdfstring{getAllRank()}{getAllRank()}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$ std\+::string, double $>$ Page\+Rank\+::get\+All\+Rank (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Return Page Rank of all pages in an unordered\+\_\+map. 

Definition at line 19 of file Page\+Rank.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{19                                                          \{}
\DoxyCodeLine{20   \textcolor{keywordflow}{return} pageRank;}
\DoxyCodeLine{21 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classPageRank_ab3dad94300779afb557d12fc20a06790}\label{classPageRank_ab3dad94300779afb557d12fc20a06790}} 
\index{PageRank@{PageRank}!getRank@{getRank}}
\index{getRank@{getRank}!PageRank@{PageRank}}
\doxysubsubsection{\texorpdfstring{getRank()}{getRank()}}
{\footnotesize\ttfamily double Page\+Rank\+::get\+Rank (\begin{DoxyParamCaption}\item[{std\+::string}]{vertex }\end{DoxyParamCaption})}

Return Page Rank of a page.


\begin{DoxyParams}{Parameters}
{\em vertex} & The vertex to get rank of \\
\hline
\end{DoxyParams}


Definition at line 12 of file Page\+Rank.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{12                                          \{}
\DoxyCodeLine{13   \textcolor{keywordflow}{return} pageRank[vertex];}
\DoxyCodeLine{14 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classPageRank_a0da9fcf460cccc1908b113cdef94722f}\label{classPageRank_a0da9fcf460cccc1908b113cdef94722f}} 
\index{PageRank@{PageRank}!printRanks@{printRanks}}
\index{printRanks@{printRanks}!PageRank@{PageRank}}
\doxysubsubsection{\texorpdfstring{printRanks()}{printRanks()}}
{\footnotesize\ttfamily void Page\+Rank\+::print\+Ranks (\begin{DoxyParamCaption}\item[{int}]{end\+Iteration\+Idx }\end{DoxyParamCaption})}

Print rank to standard out. 

Definition at line 177 of file Page\+Rank.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{177                                              \{}
\DoxyCodeLine{178   std::cout << \textcolor{stringliteral}{"{}Start printing page rank of all vertices :"{}} << std::endl;}
\DoxyCodeLine{179 }
\DoxyCodeLine{180   \textcolor{keyword}{auto} vertices = graph.\mbox{\hyperlink{classGraph_a62dc15aaab3d1a5e4268f6218d1cbbad}{getVertices}}();}
\DoxyCodeLine{181   \textcolor{keywordtype}{int} counter = 0;}
\DoxyCodeLine{182   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&vertex : vertices) \{}
\DoxyCodeLine{183     std::cout << \textcolor{stringliteral}{"{}The rank of "{}} << vertex << \textcolor{stringliteral}{"{} is : "{}} << pageRank[vertex] << \textcolor{stringliteral}{"{}. "{}} << std::endl;}
\DoxyCodeLine{184     ++counter;}
\DoxyCodeLine{185     \textcolor{keywordflow}{if} (counter >= endIterationIdx) \{}
\DoxyCodeLine{186       \textcolor{keywordflow}{break};}
\DoxyCodeLine{187     \}}
\DoxyCodeLine{188   \}}
\DoxyCodeLine{189 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classPageRank_a53f6475f0e0aa127a5ebdbe1ebdd5f1d}\label{classPageRank_a53f6475f0e0aa127a5ebdbe1ebdd5f1d}} 
\index{PageRank@{PageRank}!saveRankToFile@{saveRankToFile}}
\index{saveRankToFile@{saveRankToFile}!PageRank@{PageRank}}
\doxysubsubsection{\texorpdfstring{saveRankToFile()}{saveRankToFile()}}
{\footnotesize\ttfamily void Page\+Rank\+::save\+Rank\+To\+File (\begin{DoxyParamCaption}\item[{std\+::string}]{output,  }\item[{int}]{end\+Iteration\+Idx }\end{DoxyParamCaption})}

Print rank to a file.


\begin{DoxyParams}{Parameters}
{\em the} & output file name \\
\hline
\end{DoxyParams}


Definition at line 160 of file Page\+Rank.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{160                                                                    \{}
\DoxyCodeLine{161   std::ofstream f;}
\DoxyCodeLine{162   f.open(output);}
\DoxyCodeLine{163   \textcolor{keyword}{auto} vertices = graph.\mbox{\hyperlink{classGraph_a62dc15aaab3d1a5e4268f6218d1cbbad}{getVertices}}();}
\DoxyCodeLine{164   \textcolor{keywordtype}{int} counter = 0;}
\DoxyCodeLine{165   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&vertex : vertices) \{}
\DoxyCodeLine{166     f << \textcolor{stringliteral}{"{}The wiki page "{}} << vertex << \textcolor{stringliteral}{"{} has rank : "{}} << pageRank[vertex] << \textcolor{stringliteral}{"{}. "{}} << std::endl;}
\DoxyCodeLine{167     counter++;}
\DoxyCodeLine{168     \textcolor{keywordflow}{if} (counter >= endIterationIdx) \{}
\DoxyCodeLine{169       \textcolor{keywordflow}{break};}
\DoxyCodeLine{170     \}}
\DoxyCodeLine{171   \}}
\DoxyCodeLine{172 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
wiki\+\_\+graph/Page\+Rank.\+h\item 
wiki\+\_\+graph/Page\+Rank.\+cpp\end{DoxyCompactItemize}
